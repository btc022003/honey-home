import{ad as F,c as T,m as $,W as N,t as j,d as C,r as f,ae as q,w as y,af as U,o as K,j as H,k as v,l as M,ag as I,s as B,u as O,y as Y,z,n as G,A as J,v as W,E as Q,D as X,ah as Z,ai as ee,aj as te,F as p,G as S,H as L,J as x,N as ae,K as A,L as E,M as R}from"./index.62c3c838.js";import{d as ne}from"./request.5f65cc45.js";import{a as oe,l as se}from"./products.901c4be2.js";import{u as re,i as le,L as ie}from"./index.765106ab.js";import{C as de}from"./index.1df6404b.js";const ue=Symbol(),ce=()=>F(ue,null),[fe,b,ve]=T("list"),me={error:Boolean,offset:$(300),loading:Boolean,finished:Boolean,errorText:String,direction:N("down"),loadingText:String,finishedText:String,immediateCheck:j};var ge=C({name:fe,props:me,emits:["load","update:error","update:loading"],setup(e,{emit:d,slots:t}){const s=f(!1),n=f(),c=f(),a=ce(),h=q(n),i=()=>{M(()=>{if(s.value||e.finished||e.error||(a==null?void 0:a.value)===!1)return;const{offset:r,direction:l}=e,u=I(h);if(!u.height||le(n))return;let o=!1;const P=I(c);l==="up"?o=u.top-P.top<=r:o=P.bottom-u.bottom<=r,o&&(s.value=!0,d("update:loading",!0),d("load"))})},_=()=>{if(e.finished){const r=t.finished?t.finished():e.finishedText;if(r)return v("div",{class:b("finished-text")},[r])}},m=()=>{d("update:error",!1),i()},g=()=>{if(e.error){const r=t.error?t.error():e.errorText;if(r)return v("div",{role:"button",class:b("error-text"),tabindex:0,onClick:m},[r])}},k=()=>{if(s.value&&!e.finished)return v("div",{class:b("loading")},[t.loading?t.loading():v(ie,{class:b("loading-icon")},{default:()=>[e.loadingText||ve("loading")]})])};return y(()=>[e.loading,e.finished,e.error],i),a&&y(a,r=>{r&&i()}),U(()=>{s.value=e.loading}),K(()=>{e.immediateCheck&&i()}),re({check:i}),H("scroll",i,{target:h,passive:!0}),()=>{var r;const l=(r=t.default)==null?void 0:r.call(t),u=v("div",{ref:c,class:b("placeholder")},null);return v("div",{ref:n,role:"feed",class:b(),"aria-busy":s.value},[e.direction==="down"?l:u,k(),_(),g(),e.direction==="up"?l:u])}}});const he=B(ge),[w,_e]=T("sidebar"),D=Symbol(w),be={modelValue:$(0)};var pe=C({name:w,props:be,emits:["change","update:modelValue"],setup(e,{emit:d,slots:t}){const{linkChildren:s}=O(D),n=()=>+e.modelValue;return s({getActive:n,setActive:a=>{a!==n()&&(d("update:modelValue",a),d("change",a))}}),()=>{var a;return v("div",{role:"tablist",class:_e()},[(a=t.default)==null?void 0:a.call(t)])}}});const xe=B(pe),[ke,V]=T("sidebar-item"),Pe=Y({},z,{dot:Boolean,title:String,badge:G,disabled:Boolean,badgeProps:Object});var Se=C({name:ke,props:Pe,emits:["click"],setup(e,{emit:d,slots:t}){const s=J(),{parent:n,index:c}=W(D);if(!n)return;const a=()=>{e.disabled||(d("click",c.value),n.setActive(c.value),s())};return()=>{const{dot:h,badge:i,title:_,disabled:m}=e,g=c.value===n.getActive();return v("div",{role:"tab",class:V({select:g,disabled:m}),tabindex:m?void 0:0,"aria-selected":g,onClick:a},[v(Q,X({dot:h,class:V("text"),content:i},e.badgeProps),{default:()=>[t.title?t.title():_]})])}}});const Te=B(Se);const Ce=(e,d)=>{const t=e.__vccOpts||e;for(const[s,n]of d)t[s]=n;return t},Be={class:"list"},ye={class:"products"},Ie={__name:"List",setup(e){const d=Z(),t=ee(),s=f(t.query.tid),n=f([]);oe().then(l=>{n.value=l.data,a.value=n.value.findIndex(u=>u.id==s.value)});const c=f([]),a=f(0),h=()=>{_.value=!0,se(i.value,s.value).then(l=>{c.value.push(...l.data),_.value=!1,g.value=l.pages,i.value+=1})};te((l,u)=>{s.value=l.query.tid,a.value=n.value.findIndex(o=>o.id==s.value),g.value=1,i.value=1,m.value=!1,c.value=[],h()});const i=f(1),_=f(!1),m=f(!1),g=f(1),k=()=>{if(g.value<i.value){m.value=!0;return}h()},r=l=>{d.push({name:"Detail",query:{id:l}})};return(l,u)=>(p(),S("div",Be,[v(x(xe),{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=o=>a.value=o)},{default:L(()=>[(p(!0),S(A,null,E(n.value,o=>(p(),R(x(Te),{title:o.name,key:o.id,to:{name:"List",query:{tid:o.id}}},null,8,["title","to"]))),128))]),_:1},8,["modelValue"]),ae("div",ye,[v(x(he),{loading:_.value,finished:m.value,onLoad:k,"finished-text":"\u52A0\u8F7D\u5B8C\u6210"},{default:L(()=>[(p(!0),S(A,null,E(c.value,o=>(p(),R(x(de),{num:o.amount,price:o.price.toFixed(2),title:o.name,thumb:x(ne)(o.coverImage),onClickThumb:P=>r(o.id)},null,8,["num","price","title","thumb","onClickThumb"]))),256))]),_:1},8,["loading","finished"])])]))}},$e=Ce(Ie,[["__scopeId","data-v-e8779954"]]);export{$e as default};
