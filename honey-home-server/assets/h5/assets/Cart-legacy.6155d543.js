System.register(["./shop-carts-legacy.cf65ca7b.js","./request-legacy.4f5c48b3.js","./index-legacy.40218cae.js","./index-legacy.e8c4f3e3.js","./index-legacy.617e0240.js","./index-legacy.f7be03cc.js"],(function(e,l){"use strict";var t,a,o,n,i,s,u,r,d,c,p,m,b,g,v,h,f,k,x,V,y,S,C,B,T,w,P,I,M,z,L,G,W,j,F,A,D,N,U,_,$,E,O,q,H,J,K,X,Q,R,Y,Z,ee,le,te,ae,oe,ne,ie=document.createElement("style");return ie.innerHTML=".goods-card{margin:0;background-color:#fff}.delete-button{height:100%}\n",document.head.appendChild(ie),{setters:[e=>{t=e.l,a=e.a,o=e.d},e=>{n=e.u,i=e.d,s=e.T},e=>{u=e.O,r=e.W,d=e.n,c=e.d,p=e.y,m=e.aw,b=e.t,g=e.r,v=e.b,h=e.k,f=e.I,k=e.x,x=e.c,V=e.u,y=e.w,S=e.ax,C=e.ay,B=e.v,T=e.a4,w=e.D,P=e.s,I=e.m,M=e.ac,z=e.U,L=e.V,G=e.a0,W=e.at,j=e.S,F=e.l,A=e.$,D=e.az,N=e.ak,U=e.a,_=e.aA,$=e.j,E=e.ag,O=e.q,q=e.F,H=e.G,J=e.K,K=e.L,X=e.H,Q=e.J,R=e.M,Y=e.a9,Z=e.N,ee=e.aB},e=>{le=e.B},e=>{te=e.u,ae=e.r,oe=e.p},e=>{ne=e.C}],execute:function(){const l={name:u,shape:r("round"),disabled:Boolean,iconSize:d,modelValue:u,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var ie=c({props:p({},l,{bem:m(Function),role:String,parent:Object,checked:Boolean,bindGroup:b}),emits:["click","toggle"],setup(e,{emit:l,slots:t}){const a=g(),o=l=>{if(e.parent&&e.bindGroup)return e.parent.props[l]},n=v((()=>o("disabled")||e.disabled)),i=v((()=>o("direction"))),s=v((()=>{const l=e.checkedColor||o("checkedColor");if(l&&e.checked&&!n.value)return{borderColor:l,backgroundColor:l}})),u=t=>{const{target:o}=t,i=a.value,s=i===o||(null==i?void 0:i.contains(o));n.value||!s&&e.labelDisabled||l("toggle"),l("click",t)},r=()=>{const{bem:l,shape:i,checked:u}=e,r=e.iconSize||o("iconSize");return h("div",{ref:a,class:l("icon",[i,{disabled:n.value,checked:u}]),style:{fontSize:k(r)}},[t.icon?t.icon({checked:u,disabled:n.value}):h(f,{name:"success",style:s.value},null)])},d=()=>{if(t.default)return h("span",{class:e.bem("label",[e.labelPosition,{disabled:n.value}])},[t.default()])};return()=>{const l="left"===e.labelPosition?[d(),r()]:[r(),d()];return h("div",{role:e.role,class:e.bem([{disabled:n.value,"label-disabled":e.labelDisabled},i.value]),tabindex:n.value?void 0:0,"aria-checked":e.checked,onClick:u},[l])}}});const[se,ue]=x("checkbox-group"),re={max:d,disabled:Boolean,iconSize:d,direction:String,modelValue:C(),checkedColor:String},de=Symbol(se);c({name:se,props:re,emits:["change","update:modelValue"],setup(e,{emit:l,slots:t}){const{children:a,linkChildren:o}=V(de),n=e=>l("update:modelValue",e);return y((()=>e.modelValue),(e=>l("change",e))),te({toggleAll:(e={})=>{"boolean"==typeof e&&(e={checked:e});const{checked:l,skipDisabled:t}=e,o=a.filter((e=>!!e.props.bindGroup&&(e.props.disabled&&t?e.checked.value:null!=l?l:!e.checked.value))).map((e=>e.name));n(o)}}),S((()=>e.modelValue)),o({props:e,updateValue:n}),()=>{var l;return h("div",{class:ue([e.direction])},[null==(l=t.default)?void 0:l.call(t)])}}});const[ce,pe]=x("checkbox"),me=p({},l,{bindGroup:b});var be=c({name:ce,props:me,emits:["change","update:modelValue"],setup(e,{emit:l,slots:t}){const{parent:a}=B(de),o=v((()=>a&&e.bindGroup?-1!==a.props.modelValue.indexOf(e.name):!!e.modelValue)),n=(t=!o.value)=>{a&&e.bindGroup?(l=>{const{name:t}=e,{max:o,modelValue:n}=a.props,i=n.slice();if(l)o&&i.length>=o||i.includes(t)||(i.push(t),e.bindGroup&&a.updateValue(i));else{const l=i.indexOf(t);-1!==l&&(i.splice(l,1),e.bindGroup&&a.updateValue(i))}})(t):l("update:modelValue",t)};return y((()=>e.modelValue),(e=>l("change",e))),te({toggle:n,props:e,checked:o}),S((()=>e.modelValue)),()=>h(ie,w({bem:pe,role:"checkbox",parent:a,checked:o.value,onToggle:n},e),T(t,["default","icon"]))}});const ge=P(be),[ve,he]=x("stepper"),fe=(e,l)=>String(e)===String(l),ke={min:I(1),max:I(1/0),name:I(""),step:I(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:b,showMinus:b,showInput:b,longPress:b,allowEmpty:Boolean,modelValue:d,inputWidth:d,buttonSize:d,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:I(1),decimalLength:d};var xe=c({name:ve,props:ke,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:l}){const t=l=>{const{min:t,max:a,allowEmpty:o,decimalLength:n}=e;return o&&""===l||(l=""===(l=W(String(l),!e.integer))?0:+l,l=Number.isNaN(l)?+t:l,l=Math.max(Math.min(+a,l),+t),j(n)&&(l=l.toFixed(+n))),l};let a;const o=g(),n=g((()=>{var a;const o=null!=(a=e.modelValue)?a:e.defaultValue,n=t(o);return fe(n,e.modelValue)||l("update:modelValue",n),n})()),i=v((()=>e.disabled||e.disableMinus||n.value<=+e.min)),s=v((()=>e.disabled||e.disablePlus||n.value>=+e.max)),u=v((()=>({width:k(e.inputWidth),height:k(e.buttonSize)}))),r=v((()=>M(e.buttonSize))),d=l=>{e.beforeChange?A(e.beforeChange,{args:[l],done(){n.value=l}}):n.value=l},c=()=>{if("plus"===a&&s.value||"minus"===a&&i.value)return void l("overlimit",a);const o="minus"===a?-e.step:+e.step,u=t(D(+n.value,o));d(u),l(a)},p=l=>{const t=l.target,{value:a}=t,{decimalLength:o}=e;let i=W(String(a),!e.integer);if(j(o)&&i.includes(".")){const e=i.split(".");i=`${e[0]}.${e[1].slice(0,+o)}`}e.beforeChange?t.value=String(n.value):fe(a,i)||(t.value=i);const s=i===String(+i);d(s?+i:i)},m=t=>{var a;e.disableInput?null==(a=o.value)||a.blur():l("focus",t)},b=e=>{const a=e.target,o=t(a.value);a.value=String(o),n.value=o,F((()=>{l("blur",e),ae()}))};let f,x;const V=()=>{x=setTimeout((()=>{c(),V()}),200)},C=l=>{e.longPress&&(clearTimeout(x),f&&oe(l))},B=l=>{e.disableInput&&oe(l)},T=l=>({onClick:e=>{oe(e),a=l,c()},onTouchstartPassive:()=>{a=l,e.longPress&&(f=!1,clearTimeout(x),x=setTimeout((()=>{f=!0,c(),V()}),600))},onTouchend:C,onTouchcancel:C});return y((()=>[e.max,e.min,e.integer,e.decimalLength]),(()=>{const e=t(n.value);fe(e,n.value)||(n.value=e)})),y((()=>e.modelValue),(e=>{fe(e,n.value)||(n.value=t(e))})),y(n,(t=>{l("update:modelValue",t),l("change",t,{name:e.name})})),S((()=>e.modelValue)),()=>h("div",{role:"group",class:he([e.theme])},[z(h("button",w({type:"button",style:r.value,class:[he("minus",{disabled:i.value}),{[G]:!i.value}],"aria-disabled":i.value||void 0},T("minus")),null),[[L,e.showMinus]]),z(h("input",{ref:o,type:e.integer?"tel":"text",role:"spinbutton",class:he("input"),value:n.value,style:u.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":n.value,onBlur:b,onInput:p,onFocus:m,onMousedown:B},null),[[L,e.showInput]]),z(h("button",w({type:"button",style:r.value,class:[he("plus",{disabled:s.value}),{[G]:!s.value}],"aria-disabled":s.value||void 0},T("plus")),null),[[L,e.showPlus]])])}});const Ve=P(xe),[ye,Se,Ce]=x("submit-bar"),Be={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:r("¥"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:r("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:I(2),safeAreaInsetBottom:b};var Te=c({name:ye,props:Be,emits:["submit"],setup(e,{emit:l,slots:t}){const a=g(),o=N(a,Se),n=()=>{const{price:l,label:t,currency:a,textAlign:o,suffixLabel:n,decimalLength:i}=e;if("number"==typeof l){const e=(l/100).toFixed(+i).split("."),s=i?`.${e[1]}`:"";return h("div",{class:Se("text"),style:{textAlign:o}},[h("span",null,[t||Ce("label")]),h("span",{class:Se("price")},[a,h("span",{class:Se("price-integer")},[e[0]]),s]),n&&h("span",{class:Se("suffix-label")},[n])])}},i=()=>{var l;const{tip:a,tipIcon:o}=e;if(t.tip||a)return h("div",{class:Se("tip")},[o&&h(f,{class:Se("tip-icon"),name:o},null),a&&h("span",{class:Se("tip-text")},[a]),null==(l=t.tip)?void 0:l.call(t)])},s=()=>l("submit"),u=()=>{var l,o;return h("div",{ref:a,class:[Se(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(l=t.top)?void 0:l.call(t),i(),h("div",{class:Se("bar")},[null==(o=t.default)?void 0:o.call(t),n(),t.button?t.button():h(le,{round:!0,type:e.buttonType,text:e.buttonText,class:Se("button",e.buttonType),color:e.buttonColor,loading:e.loading,disabled:e.disabled,onClick:s},null)])])};return()=>e.placeholder?o(u):u()}});const we=P(Te),[Pe,Ie]=x("swipe-cell"),Me={name:I(""),disabled:Boolean,leftWidth:d,rightWidth:d,beforeClose:Function,stopPropagation:Boolean};var ze=c({name:Pe,props:Me,emits:["open","close","click"],setup(e,{emit:l,slots:t}){let a,o,i;const s=g(),u=g(),r=g(),d=U({offset:0,dragging:!1}),c=n(),p=e=>e.value?E(e).width:0,m=v((()=>j(e.leftWidth)?+e.leftWidth:p(u))),b=v((()=>j(e.rightWidth)?+e.rightWidth:p(r))),f=t=>{d.offset="left"===t?m.value:-b.value,a||(a=!0,l("open",{name:e.name,position:t}))},k=t=>{d.offset=0,a&&(a=!1,l("close",{name:e.name,position:t}))},x=l=>{e.disabled||(i=d.offset,c.start(l))},V=()=>{d.dragging&&(d.dragging=!1,(e=>{const l=Math.abs(d.offset),t=a?.85:.15,o="left"===e?m.value:b.value;o&&l>o*t?f(e):k(e)})(d.offset>0?"left":"right"),setTimeout((()=>{o=!1}),0))},y=(t="outside")=>{l("click",t),a&&!o&&A(e.beforeClose,{args:[{name:e.name,position:t}],done:()=>k(t)})},S=(e,l)=>t=>{l&&t.stopPropagation(),y(e)},C=(e,l)=>{const a=t[e];if(a)return h("div",{ref:l,class:Ie(e),onClick:S(e,!0)},[a()])};return te({open:f,close:k}),_(s,(()=>y("outside")),{eventName:"touchstart"}),$("touchmove",(l=>{if(e.disabled)return;const{deltaX:t}=c;c.move(l),c.isHorizontal()&&(o=!0,d.dragging=!0,(!a||t.value*i<0)&&oe(l,e.stopPropagation),d.offset=O(t.value+i,-b.value,m.value))}),{target:s}),()=>{var e;const l={transform:`translate3d(${d.offset}px, 0, 0)`,transitionDuration:d.dragging?"0s":".6s"};return h("div",{ref:s,class:Ie(),onClick:S("cell",o),onTouchstartPassive:x,onTouchend:V,onTouchcancel:V},[h("div",{class:Ie("wrapper"),style:l},[C("left",u),null==(e=t.default)?void 0:e.call(t),C("right",r)])])}}});const Le=P(ze),Ge={class:"cart"};e("default",{__name:"Cart",setup(e){const l=g([]),n=()=>{},u=()=>{},r=()=>{t().then((e=>{l.value=e.data.filter((e=>e.product)).map((e=>({...e,chk:!1})))}))};r();const d=v({set(e){l.value.forEach((l=>l.chk=e))},get:()=>l.value.every((e=>e.chk))}),c=v((()=>100*l.value.filter((e=>e.chk)).reduce(((e,l)=>e+l.amount*l.product.price),0))),p=async(e,l)=>{await a(e.product.id,l,e.product.price)};return(e,t)=>(q(),H("div",Ge,[(q(!0),H(J,null,K(l.value,(e=>(q(),R(Q(Le),null,{right:X((()=>[h(Q(le),{square:"",text:"删除",onClick:l=>(async e=>{await o(e),s.success("删除成功"),r()})(e.id),type:"danger",class:"delete-button"},null,8,["onClick"])])),default:X((()=>[h(Q(ne),{num:e.amount,price:e.product.price.toFixed(2),title:e.product.name,class:"goods-card",thumb:Q(i)(e.product.coverImage)},{tag:X((()=>[h(Q(ge),{modelValue:e.chk,"onUpdate:modelValue":l=>e.chk=l},null,8,["modelValue","onUpdate:modelValue"])])),footer:X((()=>[h(Q(Ve),{modelValue:e.amount,"onUpdate:modelValue":l=>e.amount=l,onMinus:l=>p(e,-1),onPlus:l=>p(e,1)},null,8,["modelValue","onUpdate:modelValue","onMinus","onPlus"])])),_:2},1032,["num","price","title","thumb"])])),_:2},1024)))),256)),h(Q(we),{price:Q(c),"button-text":"提交订单",onSubmit:u},{tip:X((()=>[Y(" 你的收货地址不支持配送, "),Z("span",{onClick:n},"修改地址")])),default:X((()=>[h(Q(ge),{modelValue:Q(d),"onUpdate:modelValue":t[0]||(t[0]=e=>ee(d)?d.value=e:null)},{default:X((()=>[Y("全选")])),_:1},8,["modelValue"])])),_:1},8,["price"])]))}})}}}));
